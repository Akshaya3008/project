<html>
<head>
<meta charset="ISO-8859-1">

<script src="jquery/jquery-3.3.1.min.js"></script>
<script src="jquery/bootstrap.min.js"></script>  
 <link rel="stylesheet" href="css/bootstrap.min.css">                
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="jquery/jquery.validate.min.js"></script>

<link href="css/style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<script type="text/javascript" src="javascript/ValidateLogin.js"></script>
<script type="text/javascript" src="javascript/enquiry.js"></script>
<script type="text/javascript" src="core/noty.js"></script>
<!-- <script type="text/javascript" src="javascript/feesPackage.js"></script> -->
<script type="text/javascript" src="javascript/Helper.js"></script>

<link rel="stylesheet" type="text/css" href="css/noty.css" />
<link rel="stylesheet" type="text/css" href="assets/css/ButtonStyle.css"/>
<!------ Include the above in your HEAD tag ---------->
<title>Add new Enquiry</title>

<style>
.main {
	width: 50%;
	margin: 50px auto;
}

 /* required only for this page */
.mainbox .panel-heading {
 background-color:#435d7d;
 border-color:#435d7d;
 color:#fff;
}
#enq_data_submit 
{
 background-color:#435d7d !important;
 border-color:#435d7d !important;
 color:#fff;
}
#cancel_submission{
 background-color:#435d7d !important;
 border-color:#435d7d !important;
 color:#fff;
}
#enq_data_submit:hover
{
	background-color:#53b700 !important ;
	border-color:#53b700 !important;

}
#cancel_submission:hover
{
	background-color:#d43f3a !important ;
	border-color:#d43f3a !important;	
}

input[type='radio']:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #d1d3d1;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 2px solid white;
    }

    input[type='radio']:checked:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #435d7d;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 2px solid white;
    }
    
    .panel{
    border-radius: 0px !important;
    }
    .panel-heading{
    border-radius: 0px !important;
    }
    
    .btn{
    	 border-radius: 0px !important;
    	
    }
    .controls{
    	 padding-right: 0px !important;
    }
    .input-group-addon{
     border-radius: 0px !important;
    }
    .form-control{
     border-radius: 0px !important;
	}
/* Bootstrap 4 text input with search icon */
</style>

	<script>
	$(function() {
		$("#navbar").load("nav-bar.html");
	});
</script>
</head>
<body>

<div id="navbar">
	</div>
	<div class="container">
		<div id="loginbox" style="margin-top: 50px;" class="mainbox col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">
			<div class="panel panel-info" style="border-color:#435d7d !important">
				<div class="panel-heading">
					<div class="panel-title">Student Details</div>
				</div>
				<div style="padding-top: 30px" class="panel-body">
					<div style="display: none" id="login-alert" class="alert alert-danger col-sm-12"></div>
					<form id="EnquiryForm" class="form-horizontal" method="post" role="form">
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="sname" type="text" class="form-control" name="sname" value=""placeholder="Student name" required> 
							<input id="lname" type="text" class="form-control" name="lname" value="" placeholder="Surname" required>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="fname" type="text" class="form-control" name="fname" placeholder="Father's name">
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="mname" type="text" class="form-control" name="mname" placeholder="Mother's name">
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="uid" type="text" class="form-control" name="uid" placeholder="UID/Aadhar">
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="dob" type="date" class="form-control" name="dob" placeholder="Date of Birth">
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Gender</span>
							<div class="form-control">
								<label class="radio-inline"><input type="radio" name="gender" value="M" checked>Male</label> 
								<label class="radio-inline"><input type="radio" name="gender" value="F">Female</label>
							</div>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Religion</span>
								<select name="caste" id="caste" class="form-control" required>
									<option value="Bhuddism">Buddhism</option>
									<option value="hindu">Hindu</option>
									<option value="Christanity">Christanity</option>
									<option value="Muslim">Muslim</option>
									<option value="Sikhism">Sikhism</option>
								</select>
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Caste</span>
							<select name="category" id="category" class="form-control" required>
							</select>
						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Medium</span>
							<select name="lang" id="lang" class="form-control" required>
								<option value="eng">English</option>
								<option value="hin">Hindi</option>
							</select>
						</div>

						<div class="panel-heading cont">
							<div class="panel-title cont-t">Contact Details</div>
						</div>
						<div style="padding-top: 10px" class="panel-body"></div>
						<div style="display: none" id="login-alert" class="alert alert-danger col-sm-12"></div>
						
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="stud_cont" type="number" class="form-control" name="stud_cont" value="" placeholder="Student's number">
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="father_cont" type="number" class="form-control" name="father_cont" value="" placeholder="Father's number">
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="mother_cont" type="number" class="form-control" name="mother_cont" value="" placeholder="Mother's number">
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><label for="txtarea">Address</label></span>
							<textarea id="addr" class="form-control" name="address" rows="6" cols="52"></textarea>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="pin" type="number" class="form-control" name="pin" value="" placeholder="PIN">
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
							<input id="email" type="text" class="form-control" name="email" value="" placeholder="Email id">
						</div>
						
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> 
							<input id="w_app_no" type="number" class="form-control" name="w_app_no" value="" placeholder="Whatsapp number">
						</div>

						<div class="panel-heading cont">
							<div class="panel-title cont-t">Enquiry Details</div>
						</div>

						<div style="padding-top: 10px" class="panel-body"></div>

						<div style="display: none" id="login-alert" class="alert alert-danger col-sm-12"></div>


						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Enquiry Date</span> 
							<input id="enq_date" type="date" class="form-control" name="enq_date" value="" placeholder="">

						</div>
						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Enquiry ID</span> 
							<input id="enq_no" type="number" class="form-control" name="enq_no" value="" placeholder="" readonly>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Enquiry taken by</span>
							<select name="enq_taken_by" class="form-control" id="enq_taken" required>
							</select>
							
							<span class="input-group-addon" id="bhvk">
								<button type="button" id="employee-modal" data-toggle="modal" data-target="#addEmployeeModal"
									style="background-color: transparent; border: none; font-size: 18px; color: blue; position: relative;">+</button>
							</span>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Fees package</span>
							<select name="fees_pack" class="form-control" id="fees" required>
							</select>
							
							<span class="input-group-addon" id="bhvk">
								<button type="button" id="feespackage-modal" data-toggle="modal" data-target="#myFeesPackageModal"
									style="background-color: transparent; border: none; font-size: 18px; color: blue; position: relative;">+</button>
							</span>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon">Lead source</span>
							<select name="lead_source" class="form-control" id="lead" required>

							</select>
						</div>

						<div style="margin-bottom: 25px" class="input-group">
							<span class="input-group-addon"><label for="txtarea">Remark</label></span>
							<textarea id="remark" class="form-control" name="remark" rows="6"
								cols="52"></textarea>
						</div>

						<div style="margin-top: 10px" class="form-group">
							<div class="col-sm-12 controls">
								<div class="col-sm-2 controls">
									<input type="submit" id="enq_data_submit" class="btn btn-success" value="Submit" >
								</div>
								<div class="col-sm-2 controls">
									<input type="button" id="cancel_submission" class="btn btn-success" value="Cancel">
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- modal-start -->
	<div id="addEmployeeModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form id="add_employee" method="post">
					<div class="modal-header headerClass">
						<h4 class="modal-title">Add Employee</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>Employee-Type</label> <select name="emp_type" id="emp_type" class="form-control" required disabled="disabled">
								<option value="Branch Level Employee" selected>Branch Level Employee</option>
							</select>
						</div>
						<div class="form-group">
							<label>Branch</label> <select name="branch" id="branch" class="form-control" required disabled="disabled">
								<option value="VC KIDZ">VC KIDZ</option>
								<option value="VC CLASSES">VC CLASSES</option>
								<option value="VC KIDZ - VASAI">VC KIDZ - VASAI</option>
							</select>
						</div>
						<div class="form-group">
							<label>Employee Name:</label> <input type="text" name="emp_name" id="emp_name" class="form-control" required>
						</div>
						<div class="form-group">
							<label>Employee Code Unique:</label> <input type="number" name="emp_unq_code" id="emp_unq_code" class="form-control" required>
						</div>
						<div class="form-group">
							<label>Email:</label> <input type="email" name="email" id="email" class="form-control" required>
						</div>
						<div class="form-group">
							<label>Address:</label>
							<textarea name="address" id="address" class="form-control" required></textarea>
						</div>
						<div class="form-group">
							<label>Phone</label> <input type="text" name="contact" id="contact" class="form-control" required>
						</div>
						<div class="form-group">
							<label>DOB</label>
							<div class='input-group date' id='datepicker'>
								<input type="date" name="dob" id="dob" class="form-control" required> <span class="input-group-addon"> 
								<span class="glyphicon glyphicon-calendar"></span>
								</span>
							</div>
						</div>
						<div class="form-group">
							<label>Date Of Joining</label>
							<div class='input-group date' id='datepicker'>
								<input type="date" name="join_date" id="join_date" class="form-control" required> 
								<span class="input-group-addon"> <span class="glyphicon glyphicon-calendar"></span>
								</span>
							</div>

						</div>
						<div class="form-group">
							<label>Designation</label> <select name="design" id="design"
								class="form-control designation" required>

							</select>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" id="cancelBtn" value="Cancel"> 
						<input type="submit" id="Add_employee" class="btn btn-success" value="Add">
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- modal-end -->
	<!-- Fees modal-start -->
	<div id="myFeesPackageModal" class="modal fade">
		<div class="modal-dialog" id="dialog-size">
			<div class="modal-content">

				<form id="feespackage" enctype="application/x-www-form-urlencoded" action="">
					<div class="modal-header headerClass">
						<h4 class="modal-title">Add Fees package</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">

						<div class="form-group">
							<label>Fees package <font color="red"> * </font></label> 
							<input type="text" name="fees-pack" class="form-control" id="fees_pack" required>
						</div>

						<!-- Default input -->
						<div class="form-group">
							<label for="inputDisabledEx2" class="disabled">Amount <font color="red"> * </font></label> 
							<input type="text" name="finalamt" id="inputDisabledAmt" class="form-control" readonly>
						</div>
						<hr
							style="border: 0; height: 0; border-top: 1px solid rgba(0, 0, 0, 0.1); border-bottom: 1px solid rgba(255, 255, 255, 0.3);">

						<div class="form-group" style="background-color: #f5f2eb;">
							<br> STANDARD DETAILS <br> &nbsp;&nbsp;&nbsp;&nbsp;
						</div>

						<div class="form-group">
							<div class="form-group has-search">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-search form-control-feedback"></i></span> 
									<input type="text" id="searchforstand1" class="form-control" placeholder="Search for Standard">
								</div>
							</div>
							
							<table class="table table-bordered" id="standard" name="standard">
								<thead>
									<tr>
										<th scope="col">SELECT</th>
										<th scope="col">STANDARD</th>
										<th scope="col">STANDARD FEES AMOUNT</th>
									</tr>
								</thead>
							</table>
						</div>
						<br> <br> <br>
						<hr
							style="border: 0; height: 0; border-top: 1px solid rgba(0, 0, 0, 0.1); border-bottom: 1px solid rgba(255, 255, 255, 0.3);">

						<div class="form-group">
							<button type="button" id="loadBranch" class="btn btn-default" style="background-color: #53b700; color: white">
								<b>Load Branch >></b>
							</button>
						</div>
						<div class="form-group" style="background-color: #f5f2eb;">
							<br> BRANCH DETAILS <br> &nbsp;&nbsp;&nbsp;&nbsp;
						</div>
						<div class="form-group has-search">
							<div class="input-group">
								<span class="input-group-addon"><i class="fa fa-search form-control-feedback"></i></span> 
								<input type="text" id="searchforstand2" class="form-control" placeholder="Search for Standard">
							</div>
							<br>
							<table class="table table-bordered" id="branchTable" name="branch">
								<thead>
									<tr>
										<th scope="col">SELECT</th>
										<th scope="col">BRANCH</th>
									</tr>
								</thead>
							</table>
						</div>

						<div class="form-group" style="background-color: #f5f2eb;">
							<br> FEES DETAILS <br> &nbsp;&nbsp;&nbsp;&nbsp;
						</div>
						<div class="form-group has-search">
							<br>
							<table class="table" id="feestypetable">
								<thead>
									<tr style="font-size: small;">
										<th scope="col">FEES TYPE<font color="red"> * </font></th>
										<th scope="col">AMOUNT <font color="red"> * </font></th>
										<th scope="col">DISCOUNT</th>
										<th scope="col">DISCOUNT TYPE</th>
										<th scope="col">Tax</th>
										<th scope="col">TOTAL</th>
										<th scope="col">REMOVE</th>
									</tr>
								</thead>
								<tbody id="fee-details">
									<tr>
										<td>
											<div class="form-group">
												<div class="input-group">
													<select name="feestype" class="form-control feestype" id="feestype">
													</select> <span class="input-group-addon" id="bhvk">
														<button type="button" id="fees-type-modal" data-toggle="modal" data-target="#feestypeModal"
															style="background-color: transparent; border: none; font-size: 18px; color: blue; position: relative;">
															+</button>
													</span>
												</div>
											</div>
										</td>

										<td>
											<!-- Amount Field--> 
											<input type="number" class="form-control amt" id="amount" value="" name="amount" placeholder="0.00">
										</td>

										<td>
											<!--  discount field --> 
											<input type="number" class="form-control discount" value="0" id="discount" name="discount">
										</td>

										<td>
											<div class="form-group">
												<select name="distype" class="form-control">
													<option value="INR">INR</option>
												</select>
											</div>
										</td>

										<td>
											<input type="text" id="tax" name="tax" class="form-control" placeholder="NONE">
										</td>

										<td>
											<!--Total field --> 
											<input type="text" class="form-control totala" name="price" id="total-amt" value="" readonly>
										</td>
										<td>
											<div class="w3-padding w3-xlarge w3-teal">
												<button type="button" id="remove-row">
													<i class="glyphicon glyphicon-trash"></i>
												</button>
											</div>
										</td>
									</tr>
								</tbody>
							</table>

							<div class="form-group">
								<div class="input-group" id="total-row">
									<div class="col-xs-6 col-sm-2">
										<label for="grant-t" id="total"> Total: </label>
									</div>
									<div class="col-xs-5">
										<input type="number" class="form-control" id="grand-t"
											value="0" disabled>
									</div>
								</div>
							</div>
							<button type="button" id="addrow">Add new line</button>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" id="cancelBtn" value="Cancel">
							 <button type="submit" class="btn btn-success" id="submit" >Submit</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- modal-end -->
	<!-- modal-start -->
	<div id="feestypeModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form id="feestype-form" method="post">
					<div class="modal-header headerClass">
						<h4 class="modal-title">Add Fees Type</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>Fees Type/Inventory Item<font color="red">*</font></label>
							<input type="text" class="form-control" id="feesTypeModal" name="feesType" required>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" id="cancelBtn" value="Cancel" onclick="location.reload()"> 
						<input type="submit" class="btn btn-success" value="Save" id="saveBtn">
					</div>
				</form>
			</div>
		</div>
		</div>
	<script>
		var htmlCode = new Array();
		loadFeesType();
		function loadFeesType() {

			function callback(responseData, textStatus, request) {
				for ( var i in responseData) {
					htmlCode.push('<option value="' + responseData[i].feesType + '" >'+ responseData[i].feesType + '</option>');
					
				}
					$('#feestype').append(htmlCode);
			}
			
			
			function errorCallback(responseData, textStatus, request) {
				var mes=responseData.responseJSON.message;
				showNotification("error",mes);
			}

			var httpMethod = "GET";
			var relativeUrl = "/feesType/getFeesType?branch="+branchSession;
			ajaxAuthenticatedRequest(httpMethod, relativeUrl, null, callback,
					errorCallback);
			return false;
		}
		//console.log(htmlCode);
		var html = '<tr><td><div class="form-group"><div class="input-group"><select name="feestype" class="form-control feestype" id="feestype">'
				+ htmlCode
				+ '</select><span class="input-group-addon" id="bhvk"><button type="button" id="add-btn" data-toggle="modal" data-target="#feestypeModal" style="background-color:transparent; border:none; font-size:18px; color:blue; position:relative;"> +</button></span></div></div></td><td><input type="number" class="form-control amt" id="amount" name="amount" placeholder="0.00" ></td><td><input type="number" class="form-control discount" id="discount" name="discount" value="0"></td><td><div class="form-group"><select name="distype" class="form-control"><option value="INR">INR</option></select></div></td> <td><input type="text" class="form-control" placeholder="NONE" ></td><td> <input type="text" class="form-control totala" name="price" id="total-amt" readonly></td><td><div class="w3-padding w3-xlarge w3-teal"><button type="button" id="remove-row" class="remove-row"><i class="glyphicon glyphicon-trash"></i></button></div></td></tr>"'

		$("#feestypetable").on('change', '.amt,.discount', function() {
			//alert("1");
			var discount = 0;
			var amount = 0;
			var r = document.getElementById('feestypetable');
			var noof = r.rows.length - 1;
			// var val = this.value;
			var $trr = this.closest('tr');
			amount = parseInt($(".amt", $trr).val());
			discount = parseInt($(".discount", $trr).val());
			if (amount.value != NaN) {
				$(".totala", $trr).val(amount);
			}

			if ($(".totala", $trr).val() > 0 && discount >= 0) {
				var cal = amount - discount;
				if (cal < 0) {
					alert("Profit cannot be Negative");
					$(".totala", $trr).val(0);
				} else {
					$(".totala", $trr).val(cal);
				}
			} else if ($(".totala", $trr).val() < 0) {
				alert("Input positive amount value");
				$(".totala", $trr).val(0);

			}
			getTotalPrice();

		});

		function getTotalPrice() {
			var total = 0;
			$(".totala").each(function() {
				var val = $(this).val();
				total += isNaN(val) || $.trim(val) == "" ? 0 : parseFloat(val);
			});
			$("#grand-t").val(total.toFixed(2));
			$("#inputDisabledAmt").val(total.toFixed(2));
		}

		$(function() {
			$("#addrow").click(function() {
				$("table #fee-details").append(html);
				// $("table tr td .feestype").append(htmlCode);
			});
		});
	</script>
</body>
</html>
